
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDN Chatbot Widget - Latest Features Demo</title>
    <link rel="stylesheet" href="https://chirodashboard-chat.onrender.com/chatbot-widget.css">
    <script src="https://chirodashboard-chat.onrender.com/chatbot-widget.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .feature-box {
            background: #f8f9fa;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .status.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .status.warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        .status.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ CDN Chatbot Widget - Latest Features Demo</h1>
        <p>This page demonstrates the CDN chatbot widget with ALL the latest features including suggestion buttons, line breaks, and improved UI.</p>
        
        <div class="status success">
            <strong>‚úÖ Widget Status:</strong> <span id="widget-status">Loading...</span>
        </div>
        
        <div class="feature-box">
            <h3>üÜï Latest Features Included:</h3>
            <div class="feature-list">
                <div class="feature-item">
                    <strong>üìã Suggestion Buttons</strong><br>
                    Interactive "Book Now" and "Ask Question" buttons with Calendar and HelpCircle icons
                </div>
                <div class="feature-item">
                    <strong>üé® Smart Styling</strong><br>
                    Primary color theming, hover effects, and button state management
                </div>
                <div class="feature-item">
                    <strong>üìù Line Break Support</strong><br>
                    Backend responses with \n characters render as proper line breaks
                </div>
                <div class="feature-item">
                    <strong>üëÅÔ∏è Toggle Visibility</strong><br>
                    Chat toggle button automatically hides when chat window is open
                </div>
            </div>
        </div>

        <h2>Integration Code:</h2>
        <div class="code-block">
            <code>
&lt;!-- Include CSS and JS --&gt;<br>
&lt;link rel="stylesheet" href="https://chirodashboard-chat.onrender.com/chatbot-widget.css"&gt;<br>
&lt;script src="https://chirodashboard-chat.onrender.com/chatbot-widget.js"&gt;&lt;/script&gt;<br><br>

&lt;!-- Initialize Widget --&gt;<br>
&lt;script&gt;<br>
&nbsp;&nbsp;const instance = new window.ChatbotWidget.ChatbotManager();<br>
&nbsp;&nbsp;instance.init({<br>
&nbsp;&nbsp;&nbsp;&nbsp;webhookUrl: 'https://luccatora.app.n8n.cloud/webhook/webbot',<br>
&nbsp;&nbsp;&nbsp;&nbsp;title: 'Chat Support',<br>
&nbsp;&nbsp;&nbsp;&nbsp;placeholder: 'Type your message...',<br>
&nbsp;&nbsp;&nbsp;&nbsp;position: 'bottom-right',<br>
&nbsp;&nbsp;&nbsp;&nbsp;primaryColor: '#3b82f6',<br>
&nbsp;&nbsp;&nbsp;&nbsp;secondaryColor: '#f3f4f6',<br>
&nbsp;&nbsp;&nbsp;&nbsp;textColor: '#1f2937',<br>
&nbsp;&nbsp;&nbsp;&nbsp;userTextColor: '#ffffff',<br>
&nbsp;&nbsp;&nbsp;&nbsp;chatBackground: '#ffffff',<br>
&nbsp;&nbsp;&nbsp;&nbsp;welcomeMessage: 'Hello! How can I help you today?',<br>
&nbsp;&nbsp;&nbsp;&nbsp;logoUrl: 'https://conversion-metrics-view.lovable.app/lovable-uploads/460f8654-9a04-4cac-a568-cd5421a2911e.png'<br>
&nbsp;&nbsp;});<br>
&lt;/script&gt;
            </code>
        </div>
        
        <h2>üéØ What You Should See</h2>
        <ul>
            <li><strong>Interactive Chat Toggle:</strong> Blue button in bottom-right that disappears when chat opens</li>
            <li><strong>Suggestion Buttons:</strong> "Book Now" (üìÖ) and "Ask Question" (‚ùì) buttons in welcome message</li>
            <li><strong>Smart Button Behavior:</strong> Buttons disable after first click to prevent duplicates</li>
            <li><strong>Line Break Rendering:</strong> Multi-line responses from backend display correctly</li>
            <li><strong>Custom Theming:</strong> Primary color (#3b82f6) applied to buttons and header</li>
            <li><strong>Hover Effects:</strong> Smooth animations on button interactions</li>
        </ul>

        <h2>üß™ Test the Features</h2>
        <ol>
            <li><strong>Open the chat:</strong> Click the blue chat button (it should disappear)</li>
            <li><strong>Try suggestion buttons:</strong> Click "Book Now" or "Ask Question" in the welcome message</li>
            <li><strong>Test line breaks:</strong> Send a message and check if backend responses with \n render correctly</li>
            <li><strong>Check responsiveness:</strong> Resize window to test mobile view</li>
            <li><strong>Test theming:</strong> Verify primary color is applied consistently</li>
        </ol>
        
        <div class="status warning">
            <strong>‚ö†Ô∏è Important:</strong> Make sure your webhook endpoint returns responses with \n characters for line breaks. Suggestion buttons will be disabled after first use to prevent duplicate requests.
        </div>
        
        <h2>üîß Troubleshooting</h2>
        <p>If features don't appear as expected:</p>
        <ul>
            <li>Clear browser cache and reload</li>
            <li>Check browser console for errors (F12 ‚Üí Console)</li>
            <li>Verify both CSS and JS files load (Network tab)</li>
            <li>Ensure window.ChatbotWidget.ChatbotManager is available</li>
            <li>Test webhook endpoint separately</li>
        </ul>

        <div class="feature-box">
            <h3>üîÑ Latest Update:</h3>
            <p>This demo includes all the newest features: suggestion buttons with icons, improved styling, line break support, and toggle button visibility fixes. The widget is now production-ready with enhanced user experience.</p>
        </div>
    </div>

    <!-- CDN Widget Integration -->
    <script>
        // Enhanced initialization with better error handling
        let initializationAttempts = 0;
        const maxAttempts = 50;

        function initializeChatbot() {
            initializationAttempts++;
            
            if (window.ChatbotWidget && window.ChatbotWidget.ChatbotManager) {
                const instance = new window.ChatbotWidget.ChatbotManager();
                try {
                    instance.init({
                        webhookUrl: 'https://luccatora.app.n8n.cloud/webhook/webbot',
                        title: 'Chat Support',
                        placeholder: 'Type your message...',
                        position: 'bottom-right',
                        primaryColor: '#3b82f6',
                        secondaryColor: '#f3f4f6',
                        textColor: '#1f2937',
                        userTextColor: '#ffffff',
                        chatBackground: '#ffffff',
                        welcomeMessage: 'Hello! How can I help you today?\nClick the buttons below for quick actions.',
                        logoUrl: 'https://conversion-metrics-view.lovable.app/lovable-uploads/460f8654-9a04-4cac-a568-cd5421a2911e.png'
                    });
                    document.getElementById('widget-status').textContent = '‚úÖ Widget initialized with ALL latest features (suggestion buttons, line breaks, toggle visibility)';
                    document.querySelector('.status').className = 'status success';
                    console.log('‚úÖ ChatbotWidget initialized successfully with all features');
                } catch (error) {
                    document.getElementById('widget-status').textContent = '‚ùå Error initializing widget: ' + error.message;
                    document.querySelector('.status').className = 'status error';
                    console.error('‚ùå Chatbot initialization error:', error);
                }
            } else if (initializationAttempts < maxAttempts) {
                document.getElementById('widget-status').textContent = `‚è≥ Loading widget... (${initializationAttempts}/${maxAttempts})`;
                setTimeout(initializeChatbot, 100);
            } else {
                document.getElementById('widget-status').textContent = '‚ùå Failed to load chatbot script after maximum attempts';
                document.querySelector('.status').className = 'status error';
                console.error('‚ùå ChatbotWidget failed to load');
            }
        }

        // Start initialization
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeChatbot);
        } else {
            initializeChatbot();
        }

        // Monitor script loading
        const scripts = document.querySelectorAll('script[src*="chatbot-widget"]');
        scripts.forEach(script => {
            script.addEventListener('load', () => {
                console.log('‚úÖ Chatbot script loaded successfully');
                if (!window.ChatbotWidget) {
                    setTimeout(initializeChatbot, 100);
                }
            });
            script.addEventListener('error', (e) => {
                console.error('‚ùå Failed to load chatbot script:', e);
                document.getElementById('widget-status').textContent = '‚ùå Failed to load chatbot script from CDN';
                document.querySelector('.status').className = 'status error';
            });
        });
    </script>
</body>
</html>
